; This file was automatically generated, do not edit.
; Edit file manifest/main.ml instead.

(executables
 (names test_hacl test_prop_signature_pk)
 (modes js)
 (libraries
  tezos-stdlib
  tezos-error-monad
  zarith
  zarith_stubs_js
  tezos-hacl-glue
  tezos-hacl-glue-js
  data-encoding
  qcheck-alcotest
  tezos-test-helpers)
 (flags
  (:standard
   -open Tezos_stdlib
   -open Tezos_error_monad.TzLwtreslib
   -open Data_encoding
   -open Tezos_hacl_glue))
 (modules (:standard \ test)))

(executable
 (name test)
 (modes js)
 (libraries
  tezos-hacl-glue-js)
 (modules test))

(rule (action (copy ../../unix/test/test_hacl.ml test_hacl.ml.from-unix)))

(rule
 (action (copy ../../unix/test/vectors_p256.ml vectors_p256.ml.from-unix)))

(rule
 (action
  (copy
   ../../unix/test/test_prop_signature_pk.ml
   test_prop_signature_pk.ml.from-unix)))

(rule (alias runtest_js) (action (diff test_hacl.ml test_hacl.ml.from-unix)))

(rule
 (alias runtest_js)
 (action (diff vectors_p256.ml vectors_p256.ml.from-unix)))

(rule
 (alias runtest_js)
 (action (diff test_prop_signature_pk.ml test_prop_signature_pk.ml.from-unix)))

(rule
 (alias runtest_js)
 (package tezos-hacl-glue-js)
 (deps ../.npmrc ../package.json ../package-lock.json)
 (action
  (progn
   (run npm install hacl-wasm)
   (run %{dep:../../../tooling/node_wrapper.exe} --hacl %{dep:./test.bc.js}))))

(rule
 (alias runtest_js)
 (package tezos-hacl-glue-js)
 (deps ../.npmrc ../package.json ../package-lock.json)
 (action
  (progn
   (run npm install hacl-wasm)
   (run
    %{dep:../../../tooling/node_wrapper.exe}
    --hacl
    %{dep:./test_hacl.bc.js}))))

(rule
 (alias runtest_js)
 (package tezos-hacl-glue-js)
 (deps ../.npmrc ../package.json ../package-lock.json)
 (action
  (progn
   (run npm install hacl-wasm)
   (run
    %{dep:../../../tooling/node_wrapper.exe}
    --hacl
    %{dep:./test_prop_signature_pk.bc.js}))))
